<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html>
<ui:composition 
  xmlns="http://www.w3.org/1999/xhtml" 
  xmlns:h="http://java.sun.com/jsf/html"
  xmlns:f="http://xmlns.jcp.org/jsf/core"
  xmlns:ui="http://java.sun.com/jsf/facelets" 
  xmlns:p="http://primefaces.org/ui">
  <h:panelGroup 
    id="pnlExperiencia"
    layout="block">
    <h:form
      id="frmExperienciaList"
      prependId="false"
      rendered="#{experienciaController.showList}">
      <p:toolbar>
        <f:facet 
          name="left">
          <h:outputText 
            value="#{bundle['title.experiencia']}"
            styleClass="toolbar-title"/>
        </f:facet>
        <f:facet 
          name="right">
          <p:commandButton 
            title="#{bundle['commons.btn.refresh']}"
            icon="ui-icon-refresh"
            actionListener="#{experienciaController.loadList()}"
            disabled="#{experienciaController.editable}"
            update="dtExperienciaList"/>
          <p:commandButton 
            title="#{bundle['commons.btn.new']}"
            icon="ui-icon-document"
            actionListener="#{experienciaController.onCreate()}"
            update=":tvEmpleado:pnlExperiencia"/>
          <p:commandButton 
            type="button" 
            title="#{bundle['commons.btn.print']}" 
            icon="ui-icon-print" />
        </f:facet>
      </p:toolbar>
      <p:dataTable 
        id="dtExperienciaList"
        value="#{experienciaController.list}"
        var="record"
        paginator="false" 
        selectionMode="single" 
        selection="#{experienciaController.selected}" 
        rowKey="#{record.id}">
        <p:ajax 
          event="rowSelect" 
          listener="#{experienciaController.onRowSelect}" 
          update=":tvEmpleado:pnlExperiencia" />
        <p:column 
          headerText="#{bundle['experiencia.id']}">
          <h:outputText 
            value="#{record.id}"/>
        </p:column>
        <p:column 
          headerText="#{bundle['cargo']}">
          <h:outputText 
            value="#{record.cargo}"/>
        </p:column>
        <p:column 
          headerText="#{bundle['experiencia.fechainicio']}">
          <h:outputText 
            value="#{record.fechaInicio}">
            <f:convertDateTime 
              pattern="yyyy-MM-dd"/>
          </h:outputText>
        </p:column>
        <p:column 
          headerText="#{bundle['experiencia.fechafin']}">
          <h:outputText 
            value="#{record.fechaFin}">
            <f:convertDateTime 
              pattern="yyyy-MM-dd"/>
          </h:outputText>
        </p:column>
        <p:column 
          headerText="#{bundle['experiencia.confirmado']}">
          <h:outputText 
            value="#{record.confirmado? bundle['commons.lbl.yes'] : bundle['commons.lbl.no']}"/>
        </p:column>
        <p:column 
          headerText="#{bundle['experiencia.fechaconfirmacion']}">
          <h:outputText 
            value="#{record.fechaConfirmacion}">
            <f:convertDateTime 
              pattern="yyyy-MM-dd"/>
          </h:outputText>
        </p:column>
        <p:column 
          headerText="#{bundle['tipoempresa']}">
          <h:outputText 
            value="#{record.tipoEmpresa.nombre}">
          </h:outputText>
        </p:column>
      </p:dataTable>
    </h:form>
    <h:form
      id="frmExperienciaDetail"
      prependId="false"
      rendered="#{experienciaController.showDetails}">
      <p:toolbar
        id="tbExperienciaDetails">
        <f:facet name="left">
          <h:outputText 
            value="#{bundle['experiencia']}"
            styleClass="toolbar-title"/>
        </f:facet>
        <f:facet 
          name="right">
          <p:commandButton 
            title="#{bundle['commons.btn.back']}"
            icon="ui-icon-arrowreturn-1-w"
            actionListener="#{experienciaController.onBack()}"
            disabled="#{experienciaController.editable}"
            update=":tvEmpleado:pnlExperiencia"/>
          <p:commandButton 
            title="#{bundle['commons.btn.edit']}"
            icon="ui-icon-pencil"
            actionListener="#{experienciaController.onEdit()}"
            disabled="#{experienciaController.editable}"
            update="frmExperienciaDetail"/>
          <p:commandButton 
            title="#{bundle['commons.btn.remove']}"
            icon="ui-icon-trash"
            actionListener="#{experienciaController.onDelete()}"
            immediate="true"
            disabled="#{experienciaController.newRecord}"
            update=":tvEmpleado:pnlExperiencia">
            <p:confirm 
              header="#{bundle['commons.cfmdlg.header']}" 
              message="#{bundle['commons.cfmdlg.remove.message']}" 
              icon="ui-icon-alert" />
          </p:commandButton>
        </f:facet>
      </p:toolbar>
      <p:panel
        id="pnlExperienciaDetails">
        <p:panelGrid
          columns="2">
          <!-- cargo -->
          <p:outputLabel
            for="experienciacargo"
            value="#{bundle['cargo']}"/>
          <h:panelGroup>
            <h:outputText
              value="#{experienciaController.selected.cargo}"
              rendered="#{!experienciaController.editable}"/>
            <p:inputText
              id="experienciacargo"
              value="#{experienciaController.selected.cargo}"
              rendered="#{experienciaController.editable}"/>
            <p:message
              for="experienciacargo"/>
          </h:panelGroup>
          <!-- observaciones -->
          <p:outputLabel
            for="experienciaobservaciones"
            value="#{bundle['experiencia.observaciones']}"/>
          <h:panelGroup>
            <h:outputText
              value="#{experienciaController.selected.observaciones}"
              rendered="#{!experienciaController.editable}"/>
            <p:inputTextarea
              id="experienciaobservaciones"
              value="#{experienciaController.selected.observaciones}"
              cols="50"
              rows="6"
              rendered="#{experienciaController.editable}"/>
            <p:message
              for="experienciaobservaciones"/>
          </h:panelGroup>
          <!-- fechaInicio -->
          <p:outputLabel
            for="experienciafechaInicio"
            value="#{bundle['experiencia.fechainicio']}"/>
          <h:panelGroup>
            <h:outputText
              value="#{experienciaController.selected.fechaInicio}"
              rendered="#{!experienciaController.editable}">
              <f:convertDateTime 
                pattern="yyyy-MM-dd"/>
            </h:outputText>
            <p:calendar
              id="experienciafechaInicio"
              value="#{experienciaController.selected.fechaInicio}"
              pattern="yyyy-MM-dd"
              rendered="#{experienciaController.editable}"/>
            <p:message
              for="experienciafechaInicio"/>
          </h:panelGroup>
          <!-- fechaFin -->
          <p:outputLabel
            for="experienciafechaFin"
            value="#{bundle['experiencia.fechafin']}"/>
          <h:panelGroup>
            <h:outputText
              value="#{experienciaController.selected.fechaFin}"
              rendered="#{!experienciaController.editable}">
              <f:convertDateTime 
                pattern="yyyy-MM-dd"/>
            </h:outputText>
            <p:calendar
              id="experienciafechaFin"
              value="#{experienciaController.selected.fechaFin}"
              pattern="yyyy-MM-dd"
              rendered="#{experienciaController.editable}"/>
            <p:message
              for="experienciafechaFin"/>
          </h:panelGroup>
          <!-- confirmado -->
          <p:outputLabel
            for="experienciaconfirmado"
            value="#{bundle['experiencia.confirmado']}"/>
          <h:panelGroup>
            <h:outputText 
              value="#{experienciaController.selected.confirmado? bundle['commons.lbl.yes'] : bundle['commons.lbl.no']}"
              rendered="#{!experienciaController.editable}"/>
            <p:selectBooleanButton 
              id="experienciaconfirmado" 
              value="#{experienciaController.selected.confirmado}" 
              onLabel="#{bundle['commons.lbl.yes']}" 
              offLabel="#{bundle['commons.lbl.no']}" 
              style="width:80px" 
              rendered="#{experienciaController.editable}"/>
            <p:message
              for="experienciaconfirmado"/>
          </h:panelGroup>
          <!-- fechaConfirmacion -->
          <p:outputLabel
            for="experienciafechaConfirmacion"
            value="#{bundle['experiencia.fechaconfirmacion']}"/>
          <h:panelGroup>
            <h:outputText
              value="#{experienciaController.selected.fechaConfirmacion}"
              rendered="#{!experienciaController.editable}">
              <f:convertDateTime 
                pattern="yyyy-MM-dd"/>
            </h:outputText>
            <p:calendar
              id="experienciafechaConfirmacion"
              value="#{experienciaController.selected.fechaConfirmacion}"
              pattern="yyyy-MM-dd"
              rendered="#{experienciaController.editable}"/>
            <p:message
              for="experienciafechaConfirmacion"/>
          </h:panelGroup>
          <!-- tipoEmpresa -->
          <p:outputLabel
            for="experienciatipoEmpresa"
            value="#{bundle['tipoempresa']}"/>
          <h:panelGroup>
            <h:outputText
              value="#{experienciaController.selected.tipoEmpresa.nombre}"
              rendered="#{!experienciaController.editable}"/>
            <p:selectOneMenu 
              id="experienciatipoEmpresa" 
              value="#{experienciaController.selected.tipoEmpresa}" 
              converter="itemConverter"
              required="true"
              rendered="#{experienciaController.editable}">
              <f:selectItem 
                noSelectionOption="true"/>
              <f:selectItems 
                value="#{comunController.obtenerTiposEmpresas()}" 
                var="record" 
                itemLabel="#{record.nombre}" 
                itemValue="#{record}" />
            </p:selectOneMenu>              
            <p:message
              for="experienciatipoEmpresa"/>
          </h:panelGroup>
          <!-- soportes -->
          <p:outputLabel
            for="dlSoportes"
            value="#{bundle['experiencia.soportes']}"/>
          <p:dataList 
            id="dlSoportes"
            value="#{experienciaController.selected.archivoXExperienciaList}" 
            var="archivo" 
            type="unordered" >
            <f:facet 
              name="header">
              <p:commandButton 
                title="#{bundle['commons.btn.add']}"
                icon="ui-icon-document"
                actionListener="#{experienciaController.onCreate()}"
                type="button" 
                onclick="PF('dlgSoportes').show();"/>
            </f:facet>
            <h:outputText 
              value="#{archivo.archivo.nameWhitExtension}"/>
            <p:spacer 
              width="16"/>
            <p:commandButton 
              title="#{bundle['commons.btn.remove']}"
              icon="ui-icon-trash"
              actionListener="#{experienciaController.removeSoporte(archivo)}"
              immediate="true"
              update=":tvEmpleado:dlSoportes">
              <p:confirm 
                header="#{bundle['commons.cfmdlg.header']}" 
                message="#{bundle['commons.cfmdlg.remove.message']}" 
                icon="ui-icon-alert" />
            </p:commandButton>
          </p:dataList>
        </p:panelGrid>
        <f:facet name="footer">
          <p:commandButton 
            title="#{bundle['commons.btn.save']}"
            icon="ui-icon-disk"
            actionListener="#{experienciaController.onSave()}"
            rendered="#{experienciaController.editable}"
            process="pnlExperienciaDetails"
            update="@form :frmMessage"/>
          <p:commandButton 
            title="#{bundle['commons.btn.cancel']}"
            icon="ui-icon-circle-close"
            actionListener="#{experienciaController.onCancel()}"
            immediate="true"
            rendered="#{experienciaController.editable}"
            update=":tvEmpleado:pnlExperiencia"/>
        </f:facet>
      </p:panel>
    </h:form>
    <p:dialog
      id="dlgSoportes"
      widgetVar="dlgSoportes"
      closeOnEscape="true"
      modal="true">
      <h:form>
        <p:fileUpload 
          fileUploadListener="#{experienciaController.handleFileUpload}" 
          mode="advanced"
          update=":tvEmpleado:dlSoportes" 
          auto="true" 
          multiple="true" 
          sizeLimit="100000" 
          oncomplete="PF('dlgSoportes').hide();"/>
      </h:form>
    </p:dialog>
  </h:panelGroup>
</ui:composition>