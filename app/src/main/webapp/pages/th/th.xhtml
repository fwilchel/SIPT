<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html>
<ui:composition 
  xmlns="http://www.w3.org/1999/xhtml" 
  xmlns:h="http://java.sun.com/jsf/html"
  xmlns:f="http://xmlns.jcp.org/jsf/core"
  xmlns:ui="http://java.sun.com/jsf/facelets" 
  xmlns:p="http://primefaces.org/ui" 
  template="/resources/default/template/default.xhtml">
  <ui:define
    name="content">
    <h:panelGroup 
      id="main"
      layout="block">
      <h:form
        id="frmList"
        prependId="false"
        rendered="#{empleadoController.showList}">
        <p:toolbar>
          <f:facet 
            name="left">
            <h:outputText 
              value="#{bundle['title.centrotrabajo']}"
              styleClass="toolbar-title"/>
          </f:facet>
          <f:facet 
            name="right">
            <p:commandButton 
              title="#{bundle['commons.btn.refresh']}"
              icon="ui-icon-refresh"
              actionListener="#{empleadoController.loadList()}"
              disabled="#{empleadoController.editable}"
              update="dtList"/>
            <p:commandButton 
              id="btnCreate" 
              title="#{bundle['commons.btn.new']}"
              icon="ui-icon-document"
              actionListener="#{empleadoController.onCreate()}"
              update=":main"/>
            <p:commandButton 
              type="button" 
              title="#{bundle['commons.btn.print']}" 
              icon="ui-icon-print" />
          </f:facet>
        </p:toolbar>
        <p:dataTable 
          id="dtList"
          value="#{empleadoController.list}"
          var="record"
          paginator="false" 
          selectionMode="single" 
          selection="#{empleadoController.selected}" 
          rowKey="#{record.id}">
          <p:ajax 
            event="rowSelect" 
            listener="#{empleadoController.onRowSelect}" 
            update=":main" />
          <p:column 
            headerText="#{bundle['empleado.id']}">
            <h:outputText 
              value="#{record.id}"/>
          </p:column>
          <p:column 
            headerText="#{bundle['empleado.nombres']}">
            <h:outputText 
              value="#{record.nombres}"/>
          </p:column>
          <p:column 
            headerText="#{bundle['empleado.apellidos']}">
            <h:outputText 
              value="#{record.apellidos}"/>
          </p:column>
          <p:column 
            headerText="#{bundle['empleado.identificacion.tipo']}">
            <h:outputText 
              value="#{record.identificacionTipo.nombre}"/>
          </p:column>
          <p:column 
            headerText="#{bundle['empleado.identificacion']}">
            <h:outputText 
              value="#{record.identificacion}"/>
          </p:column>
          <p:column 
            headerText="#{bundle['empleado.direccion']}">
            <h:outputText 
              value="#{record.direccion}"/>
          </p:column>
          <p:column 
            headerText="#{bundle['empleado.estado']}">
            <h:outputText 
              value="#{record.estado ? bundle['commons.lbl.active'] : bundle['commons.lbl.inactive']}"/>
          </p:column>
        </p:dataTable>
      </h:form>
      <p:panel
        rendered="#{empleadoController.showDetails}">
        <h:form
          id="frmToolBar"
          prependId="false">
          <p:toolbar
            id="tbDetails">
            <f:facet name="left">
              <h:outputText 
                value="#{bundle['empleado']}"
                styleClass="toolbar-title"/>
            </f:facet>
            <f:facet 
              name="right">
              <p:commandButton 
                title="#{bundle['commons.btn.back']}"
                icon="ui-icon-arrowreturn-1-w"
                actionListener="#{empleadoController.onBack()}"
                disabled="#{empleadoController.editable}"
                update=":main"/>
              <p:commandButton 
                title="#{bundle['commons.btn.edit']}"
                icon="ui-icon-pencil"
                actionListener="#{empleadoController.onEdit()}"
                disabled="#{empleadoController.editable}"
                update=":main"/>
              <p:commandButton 
                title="#{bundle['commons.btn.remove']}"
                icon="ui-icon-trash"
                actionListener="#{empleadoController.onDelete()}"
                immediate="true"
                disabled="#{empleadoController.newRecord}"
                update=":main">
                <p:confirm 
                  header="#{bundle['commons.cfmdlg.header']}" 
                  message="#{bundle['commons.cfmdlg.remove.message']}" 
                  icon="ui-icon-alert" />
              </p:commandButton>
            </f:facet>
          </p:toolbar>
        </h:form>
        <p:tabView
          orientation="top">
          <p:tab
            title="#{bundle['title.datosbasicos']}">
            <h:form
              id="frmDatosBasicos"
              prependId="false">
              <p:panel
                id="pnlDetails">
                <p:panelGrid
                  columns="2">
                  <!-- nombres -->
                  <p:outputLabel
                    for="nombre"
                    value="#{bundle['empleado.nombres']}"/>
                  <h:outputText
                    value="#{empleadoController.selected.nombres}"
                    rendered="#{!empleadoController.editable}"/>
                  <p:inputText
                    id="nombre"
                    value="#{empleadoController.selected.nombres}"
                    rendered="#{empleadoController.editable}"/>
                  <!-- nombres -->
                  <p:outputLabel
                    for="descripcion"
                    value="#{bundle['empleado.apellidos']}"/>
                  <h:outputText
                    value="#{empleadoController.selected.apellidos}"
                    rendered="#{!empleadoController.editable}"/>
                  <p:inputText
                    id="descripcion"
                    value="#{empleadoController.selected.apellidos}"
                    rendered="#{empleadoController.editable}"/>
                  <!-- departamento -->
                  <p:outputLabel
                    for="departamento"
                    value="#{bundle['depto']}"
                    rendered="#{empleadoController.editable}"/>
                  <p:selectOneMenu 
                    id="departamento" 
                    value="#{empleadoController.selected.municipio.departamento}" 
                    converter="deptoConverter"
                    rendered="#{empleadoController.editable}">
                    <p:ajax 
                      update="municipio" />
                    <f:selectItem 
                      noSelectionOption="true"/>
                    <f:selectItems 
                      value="#{comunController.obtenerDepartamentos()}" 
                      var="record" 
                      itemLabel="#{record.nombre}" 
                      itemValue="#{record}" />
                  </p:selectOneMenu>              
                  <!-- municipio -->
                  <p:outputLabel
                    for="municipio"
                    value="#{bundle['municipio']}"/>
                  <h:outputText
                    value="#{empleadoController.selected.municipio.nombre}"
                    rendered="#{!empleadoController.editable}"/>
                  <p:selectOneMenu 
                    id="municipio" 
                    value="#{empleadoController.selected.municipio}" 
                    converter="municipioConverter"
                    rendered="#{empleadoController.editable}">
                    <f:selectItem 
                      noSelectionOption="true"/>
                    <f:selectItems 
                      value="#{comunController.obtenerMunicipios(empleadoController.selected.municipio.departamento.id)}" 
                      var="record" 
                      itemLabel="#{record.nombre}" 
                      itemValue="#{record}" />
                  </p:selectOneMenu>              
                </p:panelGrid>
                <f:facet name="footer">
                  <p:commandButton 
                    title="#{bundle['commons.btn.save']}"
                    icon="ui-icon-disk"
                    actionListener="#{empleadoController.onSave()}"
                    rendered="#{empleadoController.editable}"
                    process="pnlDetails"
                    update=":frmMessage frmDatosBasicos"/>
                  <p:commandButton 
                    title="#{bundle['commons.btn.cancel']}"
                    icon="ui-icon-circle-close"
                    actionListener="#{empleadoController.onCancel()}"
                    immediate="true"
                    rendered="#{empleadoController.editable}"
                    update=":main"/>
                </f:facet>
              </p:panel>
            </h:form>
          </p:tab>
          <p:tab
            title="#{bundle['title.contrato']}">          
          </p:tab>
          <p:tab
            title="#{bundle['title.formacion']}">          
          </p:tab>
          <p:tab
            title="#{bundle['title.beneficiario']}">          
          </p:tab>
          <p:tab
            title="#{bundle['title.experiencia']}">          
          </p:tab>
          <p:tab
            title="#{bundle['title.dotacion']}">          
          </p:tab>
          <p:tab
            title="#{bundle['title.cesantias']}">          
          </p:tab>
        </p:tabView>
      </p:panel>
    </h:panelGroup>
  </ui:define>
</ui:composition>