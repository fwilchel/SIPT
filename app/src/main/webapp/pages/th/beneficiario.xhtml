<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html>
<ui:composition 
  xmlns="http://www.w3.org/1999/xhtml" 
  xmlns:h="http://java.sun.com/jsf/html"
  xmlns:f="http://xmlns.jcp.org/jsf/core"
  xmlns:ui="http://java.sun.com/jsf/facelets" 
  xmlns:p="http://primefaces.org/ui">
  <h:panelGroup 
    id="pnlBeneficiario"
    layout="block">
    <h:form
      id="frmBeneficiarioList"
      prependId="false"
      rendered="#{beneficiarioController.showList}">
      <p:toolbar>
        <f:facet 
          name="left">
          <h:outputText 
            value="#{bundle['title.beneficiario']}"
            styleClass="toolbar-title"/>
        </f:facet>
        <f:facet 
          name="right">
          <p:commandButton 
            title="#{bundle['commons.btn.refresh']}"
            icon="ui-icon-refresh"
            actionListener="#{beneficiarioController.loadList()}"
            disabled="#{beneficiarioController.editable}"
            update="dtBeneficiarioList"/>
          <p:commandButton 
            title="#{bundle['commons.btn.new']}"
            icon="ui-icon-document"
            actionListener="#{beneficiarioController.onCreate()}"
            update=":tvEmpleado:pnlBeneficiario"/>
          <p:commandButton 
            type="button" 
            title="#{bundle['commons.btn.print']}" 
            icon="ui-icon-print" />
        </f:facet>
      </p:toolbar>
      <p:dataTable 
        id="dtBeneficiarioList"
        value="#{beneficiarioController.list}"
        var="record"
        paginator="false" 
        selectionMode="single" 
        selection="#{beneficiarioController.selected}" 
        rowKey="#{record.id}">
        <p:ajax 
          event="rowSelect" 
          listener="#{beneficiarioController.onRowSelect}" 
          update=":tvEmpleado:pnlBeneficiario" />
        <p:column 
          headerText="#{bundle['beneficiario.id']}">
          <h:outputText 
            value="#{record.id}"/>
        </p:column>
        <p:column 
          headerText="#{bundle['tipoidentificacion']}">
          <h:outputText 
            value="#{record.tipoIdentificacion.nombre}"/>
        </p:column>
        <p:column 
          headerText="#{bundle['beneficiario.identificacion']}">
          <h:outputText 
            value="#{record.identificacion}"/>
        </p:column>
        <p:column 
          headerText="#{bundle['beneficiario.nombres']}">
          <h:outputText 
            value="#{record.nombres}"/>
        </p:column>
        <p:column 
          headerText="#{bundle['beneficiario.apellidos']}">
          <h:outputText 
            value="#{record.apellidos}"/>
        </p:column>
        <p:column 
          headerText="#{bundle['genero']}">
          <h:outputText 
            value="#{record.genero.nombre}"/>
        </p:column>
        <p:column 
          headerText="#{bundle['beneficiario.nacimiento.fecha']}">
          <h:outputText 
            value="#{record.fechaNacimiento}">
            <f:convertDateTime 
              pattern="yyyy-MM-dd"/>
          </h:outputText>
        </p:column>
        <p:column 
          headerText="#{bundle['parentesco']}">
          <h:outputText 
            value="#{record.parentesco.nombre}"/>
        </p:column>
      </p:dataTable>
    </h:form>
    <h:form
      id="frmBeneficiarioDetail"
      prependId="false"
      rendered="#{beneficiarioController.showDetails}">
      <p:toolbar
        id="tbBeneficiarioDetails">
        <f:facet name="left">
          <h:outputText 
            value="#{bundle['beneficiario']}"
            styleClass="toolbar-title"/>
        </f:facet>
        <f:facet 
          name="right">
          <p:commandButton 
            title="#{bundle['commons.btn.back']}"
            icon="ui-icon-arrowreturn-1-w"
            actionListener="#{beneficiarioController.onBack()}"
            disabled="#{beneficiarioController.editable}"
            update=":tvEmpleado:pnlBeneficiario"/>
          <p:commandButton 
            title="#{bundle['commons.btn.edit']}"
            icon="ui-icon-pencil"
            actionListener="#{beneficiarioController.onEdit()}"
            disabled="#{beneficiarioController.editable}"
            update="@form"/>
          <p:commandButton 
            title="#{bundle['commons.btn.remove']}"
            icon="ui-icon-trash"
            actionListener="#{beneficiarioController.onDelete()}"
            immediate="true"
            disabled="#{beneficiarioController.newRecord}"
            update=":tvEmpleado:pnlBeneficiario">
            <p:confirm 
              header="#{bundle['commons.cfmdlg.header']}" 
              message="#{bundle['commons.cfmdlg.remove.message']}" 
              icon="ui-icon-alert" />
          </p:commandButton>
        </f:facet>
      </p:toolbar>
      <p:panel
        id="pnlBeneficiarioDetails">
        <p:panelGrid
          columns="2">
          <!-- tipoFormacion -->
          <p:outputLabel
            for="beneficiariotipodentificacion"
            value="#{bundle['tipoidentificacion']}"/>
          <h:panelGroup>
            <h:outputText
              value="#{beneficiarioController.selected.tipoIdentificacion.nombre}"
              rendered="#{!beneficiarioController.editable}"/>
            <p:selectOneMenu 
              id="beneficiariotipodentificacion" 
              value="#{beneficiarioController.selected.tipoIdentificacion}" 
              converter="itemConverter"
              required="true"
              rendered="#{beneficiarioController.editable}">
              <f:selectItem 
                noSelectionOption="true"/>
              <f:selectItems 
                value="#{comunController.obtenerTiposIdentificaciones()}" 
                var="record" 
                itemLabel="#{record.nombre}" 
                itemValue="#{record}" />
            </p:selectOneMenu>              
            <p:message
              for="beneficiariotipodentificacion"/>
          </h:panelGroup>
          <!-- identificacion -->
          <p:outputLabel
            for="beneficiarioidentificacion"
            value="#{bundle['beneficiario.identificacion']}"/>
          <h:panelGroup>
            <h:outputText
              value="#{beneficiarioController.selected.identificacion}"
              rendered="#{!beneficiarioController.editable}"/>
            <p:inputText
              id="beneficiarioidentificacion"
              value="#{beneficiarioController.selected.identificacion}"
              rendered="#{beneficiarioController.editable}"/>
            <p:message
              for="beneficiarioidentificacion"/>
          </h:panelGroup>
          <!-- nombres -->
          <p:outputLabel
            for="beneficiarionombres"
            value="#{bundle['beneficiario.nombres']}"/>
          <h:panelGroup>
            <h:outputText
              value="#{beneficiarioController.selected.nombres}"
              rendered="#{!beneficiarioController.editable}"/>
            <p:inputText
              id="beneficiarionombres"
              value="#{beneficiarioController.selected.nombres}"
              rendered="#{beneficiarioController.editable}"/>
            <p:message
              for="beneficiarionombres"/>
          </h:panelGroup>
          <!-- apellidos -->
          <p:outputLabel
            for="beneficiarioapellidos"
            value="#{bundle['beneficiario.apellidos']}"/>
          <h:panelGroup>
            <h:outputText
              value="#{beneficiarioController.selected.apellidos}"
              rendered="#{!beneficiarioController.editable}"/>
            <p:inputText
              id="beneficiarioapellidos"
              value="#{beneficiarioController.selected.apellidos}"
              rendered="#{beneficiarioController.editable}"/>
            <p:message
              for="beneficiarioapellidos"/>
          </h:panelGroup>
          <!-- genero -->
          <p:outputLabel
            for="beneficiariogenero"
            value="#{bundle['genero']}"/>
          <h:panelGroup>
            <h:outputText
              value="#{beneficiarioController.selected.genero.nombre}"
              rendered="#{!beneficiarioController.editable}"/>
            <p:selectOneMenu 
              id="beneficiariogenero" 
              value="#{beneficiarioController.selected.genero}" 
              converter="itemConverter"
              required="true"
              rendered="#{beneficiarioController.editable}">
              <f:selectItem 
                noSelectionOption="true"/>
              <f:selectItems 
                value="#{comunController.obtenerGeneros()}" 
                var="record" 
                itemLabel="#{record.nombre}" 
                itemValue="#{record}" />
            </p:selectOneMenu>              
            <p:message
              for="beneficiariogenero"/>
          </h:panelGroup>
          <!-- fecha -->
          <p:outputLabel
            for="beneficiariofecha"
            value="#{bundle['beneficiario.nacimiento.fecha']}"/>
          <h:panelGroup>
            <h:outputText
              value="#{beneficiarioController.selected.fechaNacimiento}"
              rendered="#{!beneficiarioController.editable}">
              <f:convertDateTime 
                pattern="yyyy-MM-dd"/>
            </h:outputText>
            <p:calendar
              id="beneficiariofecha"
              value="#{beneficiarioController.selected.fechaNacimiento}"
              rendered="#{beneficiarioController.editable}"
              pattern="yyyy-MM-dd"/>
            <p:message
              for="beneficiariofecha"/>
          </h:panelGroup>
          <!-- parentesco -->
          <p:outputLabel
            for="beneficiarioparentesco"
            value="#{bundle['parentesco']}"/>
          <h:panelGroup>
            <h:outputText
              value="#{beneficiarioController.selected.parentesco.nombre}"
              rendered="#{!beneficiarioController.editable}"/>
            <p:selectOneMenu 
              id="beneficiarioparentesco" 
              value="#{beneficiarioController.selected.parentesco}" 
              converter="itemConverter"
              required="true"
              rendered="#{beneficiarioController.editable}">
              <f:selectItem 
                noSelectionOption="true"/>
              <f:selectItems 
                value="#{comunController.obtenerParentescos()}" 
                var="record" 
                itemLabel="#{record.nombre}" 
                itemValue="#{record}" />
            </p:selectOneMenu>              
            <p:message
              for="beneficiarioparentesco"/>
          </h:panelGroup>
        </p:panelGrid>
        <f:facet name="footer">
          <p:commandButton 
            title="#{bundle['commons.btn.save']}"
            icon="ui-icon-disk"
            actionListener="#{beneficiarioController.onSave()}"
            rendered="#{beneficiarioController.editable}"
            process="pnlBeneficiarioDetails"
            update="@form :frmMessage"/>
          <p:commandButton 
            title="#{bundle['commons.btn.cancel']}"
            icon="ui-icon-circle-close"
            actionListener="#{beneficiarioController.onCancel()}"
            immediate="true"
            rendered="#{beneficiarioController.editable}"
            update=":tvEmpleado:pnlBeneficiario"/>
        </f:facet>
      </p:panel>
    </h:form>  
  </h:panelGroup>
</ui:composition>